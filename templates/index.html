<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Form Creator</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='style_components.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app-container">
        <header class="app-header">
            <div class="header-wrapper">
                <div class="header-brand">
                    <h1>AI Form Creator</h1>
                    <p class="header-subtitle">Create professional Google Forms with AI</p>
                </div>
                <div id="auth-section" class="auth-section">
                    <a href="/help" class="btn-auth" style="margin-right: 0.5rem; background: var(--secondary);">Help</a>
                    {% if user_logged_in %}
                        <div class="auth-info">
                            <span class="user-email">{{ user_email }}</span>
                            <button class="btn-auth btn-logout" onclick="logout()">Logout</button>
                        </div>
                    {% else %}
                        <a href="/auth/login" class="btn-auth btn-login">Sign in</a>
                    {% endif %}
                </div>
            </div>
        </header>

        <main class="app-main">
            <div class="tabs-container">
                <button class="tab active" data-tab="text">Text</button>
                <button class="tab" data-tab="file">File</button>
                <button class="tab" data-tab="docs">Docs</button>
                <button class="tab" data-tab="script">Script</button>
            </div>

            <!-- Text Input Tab -->
            <div class="tab-panel active" id="text-tab">
                <div class="panel-content">
                    <div class="panel-header">
                        <h2>Describe your form</h2>
                        <p>Enter your requirements and let AI create a professional form</p>
                    </div>
                    
                    <div class="form-field">
                        <textarea 
                            id="text-input" 
                            class="textarea"
                            placeholder="Example: Create a customer feedback form with name, email, rating (1-5), and comments..."
                            rows="8"
                        ></textarea>
                    </div>
                    
                    <div class="settings-bar">
                        <span class="settings-label">Default setting:</span>
                        <div class="settings-toggle">
                            <button class="toggle-btn" id="set-default-required-btn">All Required</button>
                            <button class="toggle-btn" id="set-default-optional-btn">All Optional</button>
                        </div>
                    </div>
                    
                    <button class="btn-primary" id="create-from-text-btn">
                        <span class="btn-label">Create Form</span>
                        <span class="btn-loader" style="display: none;">Creating...</span>
                    </button>
                    
                    <div id="log-console-text" class="log-panel" style="display: none;">
                        <div class="log-header">Generation Log</div>
                        <div id="log-content-text" class="log-content"></div>
                    </div>
                </div>
            </div>

            <!-- File Upload Tab -->
            <div class="tab-panel" id="file-tab">
                <div class="panel-content">
                    <div class="panel-header">
                        <h2>Upload document</h2>
                        <p>Upload a file and we'll create a form from its content</p>
                    </div>
                    
                    <div class="form-field">
                        <div class="upload-zone" id="upload-area">
                            <div class="upload-icon">ðŸ“„</div>
                            <p class="upload-text">Drag and drop your file here</p>
                            <p class="upload-subtext">or click to browse</p>
                            <p class="upload-hint">TXT, PDF, DOCX, XLSX, CSV (Max 16MB)</p>
                            <input type="file" id="file-input" accept=".txt,.pdf,.docx,.doc,.csv,.xlsx,.xls" style="display: none;">
                        </div>
                        
                        <div id="file-info" class="file-preview" style="display: none;">
                            <span class="file-name"></span>
                            <button class="btn-remove" id="remove-file-btn">Ã—</button>
                        </div>
                    </div>
                    
                    <div class="settings-bar">
                        <span class="settings-label">Default setting:</span>
                        <div class="settings-toggle">
                            <button class="toggle-btn" id="set-default-required-btn-file">All Required</button>
                            <button class="toggle-btn" id="set-default-optional-btn-file">All Optional</button>
                        </div>
                    </div>
                    
                    <button class="btn-primary" id="create-from-file-btn" disabled>
                        <span class="btn-label">Create Form</span>
                        <span class="btn-loader" style="display: none;">Creating...</span>
                    </button>
                    
                    <div id="log-console-file" class="log-panel" style="display: none;">
                        <div class="log-header">Generation Log</div>
                        <div id="log-content-file" class="log-content"></div>
                    </div>
                </div>
            </div>

            <!-- Google Docs Link Tab -->
            <div class="tab-panel" id="docs-tab">
                <div class="panel-content">
                    <div class="panel-header">
                        <h2>Google Docs link</h2>
                        <p>Paste a link to a Google Docs document</p>
                    </div>
                    
                    <div class="form-field">
                        <input 
                            type="text" 
                            id="docs-url-input" 
                            placeholder="https://docs.google.com/document/d/..."
                            class="input"
                        />
                        <div class="field-hint">
                            <p><strong>Supported formats:</strong></p>
                            <ul>
                                <li>https://docs.google.com/document/d/DOC_ID/edit</li>
                                <li>https://docs.google.com/document/d/DOC_ID/view</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="settings-bar">
                        <span class="settings-label">Default setting:</span>
                        <div class="settings-toggle">
                            <button class="toggle-btn" id="set-default-required-btn-docs">All Required</button>
                            <button class="toggle-btn" id="set-default-optional-btn-docs">All Optional</button>
                        </div>
                    </div>
                    
                    <button class="btn-primary" id="create-from-docs-btn">
                        <span class="btn-label">Create Form</span>
                        <span class="btn-loader" style="display: none;">Creating...</span>
                    </button>
                    
                    <div id="log-console-docs" class="log-panel" style="display: none;">
                        <div class="log-header">Generation Log</div>
                        <div id="log-content-docs" class="log-content"></div>
                    </div>
                </div>
            </div>

            <!-- Form Script Tab -->
            <div class="tab-panel" id="script-tab">
                <div class="panel-content">
                    <div class="panel-header">
                        <h2>Form script</h2>
                        <p>Upload a script file or paste the code directly</p>
                    </div>
                    
                    <div class="form-field">
                        <div class="upload-zone" id="script-upload-area">
                            <div class="upload-icon">ðŸ“œ</div>
                            <p class="upload-text">Drag and drop script file</p>
                            <p class="upload-subtext">or click to browse</p>
                            <p class="upload-hint">Google Apps Script (.gs, .js) or JSON (.json)</p>
                            <input type="file" id="script-file-input" accept=".gs,.js,.json" style="display: none;">
                        </div>
                    </div>
                    
                    <div class="divider">
                        <span>or</span>
                    </div>
                    
                    <div class="form-field">
                        <textarea 
                            id="script-text-input" 
                            class="textarea code-textarea"
                            placeholder='// Google Apps Script or JSON format...'
                            rows="12"
                        ></textarea>
                    </div>
                    
                    <div class="settings-bar">
                        <span class="settings-label">Default setting:</span>
                        <div class="settings-toggle">
                            <button class="toggle-btn" id="set-default-required-btn-script">All Required</button>
                            <button class="toggle-btn" id="set-default-optional-btn-script">All Optional</button>
                        </div>
                    </div>
                    
                    <button class="btn-primary" id="create-from-script-btn">
                        <span class="btn-label">Create Form</span>
                        <span class="btn-loader" style="display: none;">Creating...</span>
                    </button>
                    
                    <div id="log-console-script" class="log-panel" style="display: none;">
                        <div class="log-header">Generation Log</div>
                        <div id="log-content-script" class="log-content"></div>
                    </div>
                </div>
            </div>

            <!-- Question Preview Section -->
            <div id="question-preview-section" class="preview-section" style="display: none;">
                <div class="panel-content">
                    <div class="panel-header">
                        <h2>Review questions</h2>
                        <p>Review and adjust required/optional settings before creating</p>
                    </div>
                    
                    <div class="preview-actions-bar">
                        <button class="btn-secondary" id="select-all-required-btn">Set All Required</button>
                        <button class="btn-secondary" id="select-all-optional-btn">Set All Optional</button>
                    </div>
                    
                    <div id="questions-list" class="questions-list"></div>
                    
                    <div class="action-buttons">
                        <button class="btn-primary" id="create-form-btn">
                            <span class="btn-label">Create Form</span>
                            <span class="btn-loader" style="display: none;">Creating...</span>
                        </button>
                        <button class="btn-secondary" id="back-to-edit-btn">Back</button>
                    </div>
                </div>
            </div>

            <!-- Result Section -->
            <div id="result-section" class="result-section" style="display: none;">
                <div class="result-card success">
                    <div class="result-icon">âœ“</div>
                    <h2>Form created successfully</h2>
                    <p class="result-message">Your Google Form is ready to use</p>
                    <div class="result-actions">
                        <a href="#" id="form-url" target="_blank" class="btn-primary">View Form</a>
                        <a href="#" id="form-edit-url" target="_blank" class="btn-secondary">Edit Form</a>
                        <button class="btn-secondary" id="create-another-btn">Create Another</button>
                    </div>
                </div>
            </div>

            <!-- Error Section -->
            <div id="error-section" class="result-section" style="display: none;">
                <div class="result-card error">
                    <div class="result-icon">âœ•</div>
                    <h2>Error creating form</h2>
                    <p class="error-message" id="error-message"></p>
                    <div class="result-actions">
                        <button class="btn-primary" id="try-again-btn">Try Again</button>
                    </div>
                </div>
            </div>
        </main>

        <footer class="app-footer">
            <p>Powered by Google Gemini AI & Google Forms API</p>
            <p>Made with love by pnam.ng</p>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
